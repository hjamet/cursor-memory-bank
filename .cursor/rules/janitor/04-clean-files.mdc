---
alwaysApply: false
description: Nettoyage syst√©matique des fichiers avec boucle interne pour traiter tous les sous-dossiers
---

# √âtape 04 : Nettoyage Syst√©matique des Fichiers üßπ

## ‚ö†Ô∏è SYST√àME √Ä √âTATS - RAPPEL OBLIGATOIRE

Vous √™tes actuellement dans une **machine √† √©tats stricte** pour le nettoyage du repository :

### R√®gles de fonctionnement
- ‚úÖ **UNIQUEMENT** effectuer les actions d√©crites dans cette r√®gle
- ‚ùå **INTERDICTION ABSOLUE** de faire autre chose (m√™me si √ßa semble utile)
- ‚ùå **NE RIEN CASSER** : pr√©server fonctionnalit√© existante
- ‚úÖ **OBLIGATION** d'invoquer la r√®gle suivante en fin d'√©tape avec l'outil `fetch_rules`

### Machine √† √©tats
Cette √©tape fait partie d'un processus en 6 √©tapes :
`00-start ‚Üí 01-root-check ‚Üí 02-select-folder ‚Üí 03-explore-folder ‚Üí 04-clean-files ‚ü≤ ‚Üí 05-update-docs`

**Votre √©tape actuelle** : 04-clean-files - Nettoyage syst√©matique des fichiers

---

## Objectif de l'√âtape 04

**Nettoyer syst√©matiquement tous les fichiers et sous-dossiers** du dossier s√©lectionn√©, avec une boucle interne pour traiter chaque sous-dossier individuellement.

### Actions Obligatoires √† Effectuer

1. **Ex√©cuter la restructuration pr√©par√©e** :
   - Cr√©er les sous-dossiers n√©cessaires (si >5 fichiers)
   - D√©placer les fichiers vers leurs nouveaux emplacements
   - Modifier les scripts pour g√©n√©rer dans les bons dossiers

2. **Traiter chaque sous-dossier en boucle** :
   - Pour chaque sous-dossier identifi√© :
     - Analyser le contenu (fichiers, code, documentation)
     - Nettoyer les fichiers temporaires et obsol√®tes
     - V√©rifier et mettre √† jour la documentation
     - Cr√©er/mettre √† jour le fichier Markdown du sous-dossier

3. **Nettoyage des fichiers individuels** :
   - **Fichiers temporaires** : `.tmp`, `.temp`, `.cache`, `.log`, `.bak`, `.swp`
   - **Code legacy** : fonctions obsol√®tes, d√©pendances p√©rim√©es
   - **Code redondant** : doublons, fonctions similaires
   - **Documentation manquante** : ajouter des commentaires et docs

4. **V√©rification et correction des scripts d√©plac√©s** :
   - **Analyser chaque script d√©plac√©** pour identifier les chemins relatifs
   - **D√©tecter les d√©pendances de localisation** : chemins vers fichiers, dossiers, imports
   - **Corriger les chemins cass√©s** : ajuster les chemins relatifs selon la nouvelle localisation
   - **Tester les corrections** : v√©rifier que le script fonctionne toujours apr√®s d√©placement
   - **Exemples de corrections** :
     - `open('data.json')` ‚Üí `open('../data.json')` si d√©plac√© dans un sous-dossier
     - `import utils` ‚Üí `import ..utils` si d√©plac√© dans un sous-dossier
     - `os.path.join('.', 'config')` ‚Üí `os.path.join('..', 'config')` si d√©plac√©

5. **V√©rification des scripts de g√©n√©ration** :
   - Analyser les scripts qui g√©n√®rent des fichiers
   - Modifier les chemins de sortie si n√©cessaire
   - Tester que les scripts modifi√©s fonctionnent toujours

6. **Cr√©ation/Mise √† jour des fichiers Markdown** :
   - Pour chaque sous-dossier : cr√©er/mettre √† jour le fichier README.md
   - Respecter le format standardis√© (max 100 lignes)
   - Assurer la connectivit√© avec le fichier parent

### Gestion de la Boucle Interne

#### √âtat de la Boucle
- **Sous-dossiers trait√©s** : liste des dossiers d√©j√† nettoy√©s
- **Sous-dossiers restants** : liste des dossiers √† traiter
- **Dossier actuel** : sous-dossier en cours de traitement

#### Conditions de Boucle
- **Si sous-dossiers restants** ‚Üí r√©invoquer `04-clean-files`
- **Si tous sous-dossiers trait√©s** ‚Üí transiter vers `05-update-docs`

#### Format de Suivi
```
√âtat de la boucle :
- Dossier principal : tests/
- Sous-dossiers trait√©s : [unit/, fixtures/]
- Sous-dossier actuel : integration/
- Sous-dossiers restants : []
```

### Types de Nettoyage par Fichier

#### Fichiers de Code
- **Fonctions legacy** : supprimer ou marquer comme d√©pr√©ci√©es
- **Code redondant** : identifier et √©liminer les doublons
- **Documentation** : ajouter des commentaires manquants
- **Imports** : nettoyer les imports inutilis√©s
- **Chemins relatifs** : corriger les chemins cass√©s apr√®s d√©placement

#### Fichiers de Configuration
- **D√©pendances obsol√®tes** : mettre √† jour les versions
- **Chemins cass√©s** : corriger les r√©f√©rences
- **Configuration p√©rim√©e** : actualiser les valeurs

#### Fichiers de Documentation
- **Format standardis√©** : respecter le template (max 100 lignes)
- **Liens internes** : v√©rifier et corriger les r√©f√©rences
- **Contenu obsol√®te** : mettre √† jour avec l'√©tat actuel

### Sortie Attendue

√Ä la fin de cette √©tape, vous devez fournir :
- **√âtat de la boucle** : progression du traitement des sous-dossiers
- **Actions effectu√©es** : liste d√©taill√©e des nettoyages
- **Fichiers modifi√©s** : scripts corrig√©s, documentation mise √† jour
- **D√©cision de transition** : continuer la boucle ou passer √† l'√©tape suivante

### Exemple de Sortie

```
√âtat de la boucle :
- Dossier principal : tests/
- Sous-dossiers trait√©s : [unit/, fixtures/]
- Sous-dossier actuel : integration/
- Sous-dossiers restants : []

Actions effectu√©es sur integration/ :
- Supprim√© : temp_test_data.json, debug.log
- Modifi√© : test_api_integration.py (ajout√© documentation)
- D√©plac√© : run_tests.sh ‚Üí scripts/run_tests.sh (corrig√© chemins relatifs)
- Cr√©√© : integration/README.md (format standardis√©)
- Test√© : scripts/run_tests.sh fonctionne avec nouveaux chemins

D√©cision : Tous les sous-dossiers trait√©s ‚Üí Transition vers 05-update-docs
```

### R√®gles de S√©curit√©

1. **Principe Fail-Fast** : arr√™t imm√©diat si une modification risque de casser
2. **Jamais de suppression aveugle** : v√©rifier l'utilisation avant suppression
3. **Tester les modifications** : v√©rifier que les scripts modifi√©s fonctionnent
4. **Conserver l'int√©grit√©** : pr√©server la fonctionnalit√© existante
5. **V√©rifier les chemins** : analyser et corriger les d√©pendances de localisation apr√®s d√©placement

---

## Transitions Possibles

**Deux options selon l'√©tat de la boucle** :

1. **Vers `04-clean-files`** : Si des sous-dossiers restent √† traiter (boucle interne)
2. **Vers `05-update-docs`** : Si tous les sous-dossiers sont trait√©s

**Action requise** : 
- Si sous-dossiers restants ‚Üí invoquer `fetch_rules` avec `04-clean-files`
- Si tous trait√©s ‚Üí invoquer `fetch_rules` avec `05-update-docs`