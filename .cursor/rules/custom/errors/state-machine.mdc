---
description: [state-machine] - Erreurs courantes et bonnes pratiques pour les machines Ã  Ã©tats
globs: .cursor/rules/*.mdc
alwaysApply: false
---
# Machine Ã  Ã©tats Cursor

## Transition sans Ã©tat prÃ©alable
- âŒ `context-update` : Si test amÃ©liorÃ©
- âœ… `context-update` : Si test amÃ©liorÃ© OU premiÃ¨re exÃ©cution

## DÃ©tection de cycles
- âŒ EnchaÃ®nement sans vÃ©rification: rule1 -> rule2 -> rule1
- âœ… Compteur d'itÃ©rations: max 2 cycles identiques

# Erreurs courantes avec les Machines Ã  Ã‰tats

## ProblÃ¨me: Conditions de transition incomplÃ¨tes
- âŒ **Incorrect**: DÃ©finir des conditions de transition qui ne couvrent pas tous les cas possibles ou qui supposent un Ã©tat prÃ©alable spÃ©cifique.
  ```
  ## Next Rules
  - `context-update` : Si au moins un test s'est amÃ©liorÃ©
  - `fix` : Si aucun test ne s'est amÃ©liorÃ©
  ```
- âœ… **Correct**: Inclure des conditions pour la premiÃ¨re exÃ©cution et tous les cas possibles.
  ```
  ## Next Rules
  - `context-update` : Si au moins un test s'est amÃ©liorÃ© OU si c'est la premiÃ¨re exÃ©cution et que tous les tests sont documentÃ©s
  - `fix` : Si aucun test ne s'est amÃ©liorÃ© ET ce n'est pas la premiÃ¨re exÃ©cution OU si des tests Ã©chouent
  ```
- ğŸ“ **Explication**: Une machine Ã  Ã©tats doit gÃ©rer tous les cas possibles, y compris la premiÃ¨re exÃ©cution oÃ¹ aucun Ã©tat prÃ©alable n'existe.

## ProblÃ¨me: Boucles infinies dans le workflow
- âŒ **Incorrect**: CrÃ©er des cycles dans le workflow sans condition de sortie claire.
  ```
  context-update -> implementation -> tests -> context-update
  ```
- âœ… **Correct**: Ajouter des conditions de sortie explicites ou un compteur d'itÃ©rations.
  ```
  context-update [si toutes les tÃ¢ches sont terminÃ©es -> FIN]
               -> implementation -> tests -> context-update
  ```
- ğŸ“ **Explication**: Tout workflow cyclique doit avoir une condition de sortie claire ou un mÃ©canisme pour dÃ©tecter les boucles infinies.

## ProblÃ¨me: Absence de critÃ¨res de finalisation
- âŒ **Incorrect**: Ne pas dÃ©finir clairement quand le workflow est considÃ©rÃ© comme terminÃ©.
  ```
  4. Si toutes les tÃ¢ches sont terminÃ©es et tous les tests passent:
     - PrÃ©senter une synthÃ¨se du travail effectuÃ©
  ```
- âœ… **Correct**: DÃ©finir prÃ©cisÃ©ment les critÃ¨res de finalisation et les actions Ã  entreprendre.
  ```
  4. Si toutes les tÃ¢ches sont terminÃ©es (c'est-Ã -dire qu'il n'y a plus de tÃ¢ches dans "In Progress" ou "ToDo") ET que tous les tests passent (tous marquÃ©s âœ…):
     - PrÃ©senter une synthÃ¨se du travail effectuÃ©
     - Indiquer clairement que le workflow est terminÃ©
     - Ne pas appeler de rÃ¨gle suivante
  ```
- ğŸ“ **Explication**: La finalisation d'un workflow doit Ãªtre explicitement dÃ©finie avec des critÃ¨res prÃ©cis pour Ã©viter l'ambiguÃ¯tÃ©. 